

<html>
    <head>
        <title>UEFA tool</title>
<!--
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
-->
        <link rel="stylesheet" type="text/css" href="/static/css/UEFAtool.css">
        <link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css">
        <link rel="shortcut icon" type="image/png" href="{{STATIC_URL}}/favicon.ico"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>

    <body>


      {% include "mysite/header.html" %}
<dic class="container">
      <form id="CriteriaForm">
        <div class="form-group row">
        </div>
        <div class="form-group row required">
          <label for="colFormLabelSm" class="col-sm-3 col-form-label col-form-label-sm col-xs-4">Season Start</label>
          <div class="col-sm-6 col-xs-8">
            <select class="custom-select form-control" id="StSeasonBtn" onclick="checkSeasons()">
              <option selected value="0">Select season</option>
              <option value="1956">1955/1956</option>
              <option value="1957">1956/1957</option>
              <option value="1958">1957/1958</option>
              <option value="1959">1958/1959</option>
              <option value="1960">1959/1960</option>
              <option value="1961">1960/1961</option>
              <option value="1962">1961/1962</option>
              <option value="1963">1962/1963</option>
              <option value="1964">1963/1964</option>
              <option value="1965">1964/1965</option>
              <option value="1966">1965/1966</option>
              <option value="1967">1966/1967</option>
              <option value="1968">1967/1968</option>
              <option value="1969">1968/1969</option>
              <option value="1970">1969/1970</option>
              <option value="1971">1970/1971</option>
              <option value="1972">1971/1972</option>
              <option value="1973">1972/1973</option>
              <option value="1974">1973/1974</option>
              <option value="1975">1974/1975</option>
              <option value="1976">1975/1976</option>
              <option value="1977">1976/1977</option>
              <option value="1978">1977/1978</option>
              <option value="1979">1978/1979</option>
              <option value="1980">1979/1980</option>
              <option value="1981">1980/1981</option>
              <option value="1982">1981/1982</option>
              <option value="1983">1982/1983</option>
              <option value="1984">1983/1984</option>
              <option value="1985">1984/1985</option>
              <option value="1986">1985/1986</option>
              <option value="1987">1986/1987</option>
              <option value="1988">1987/1988</option>
              <option value="1989">1988/1989</option>
              <option value="1990">1989/1990</option>
              <option value="1991">1990/1991</option>
              <option value="1992">1991/1992</option>
              <option value="1993">1992/1993</option>
              <option value="1994">1993/1994</option>
              <option value="1995">1994/1995</option>
              <option value="1996">1995/1996</option>
              <option value="1997">1996/1997</option>
              <option value="1998">1997/1998</option>
              <option value="1999">1998/1999</option>
              <option value="2000">1999/2000</option>
              <option value="2001">2000/2001</option>
              <option value="2002">2001/2002</option>
              <option value="2003">2002/2003</option>
              <option value="2004">2003/2004</option>
              <option value="2005">2004/2005</option>
              <option value="2006">2005/2006</option>
              <option value="2007">2006/2007</option>
              <option value="2008">2007/2008</option>
              <option value="2009">2008/2009</option>
              <option value="2010">2009/2010</option>
              <option value="2011">2010/2011</option>
              <option value="2012">2011/2012</option>
              <option value="2013">2012/2013</option>
              <option value="2014">2013/2014</option>
              <option value="2015">2014/2015</option>
              <option value="2016">2015/2016</option>
              <option value="2017">2016/2017</option>

            </select>

            <div class="valid-feedback" id="valid1">
              Please select season
            </div>

          </div>
        </div>
        <div class="form-group row required">
          <label for="colFormLabel" class="col-sm-3 col-form-label col-xs-4">Season End</label>
          <div class="col-sm-6 col-xs-8">
            <select class="custom-select form-control" id="EndSeasonBtn">
              <option selected value="0">Select season</option>
              <option value="1956">1955/1956</option>
              <option value="1957">1956/1957</option>
              <option value="1958">1957/1958</option>
              <option value="1959">1958/1959</option>
              <option value="1960">1959/1960</option>
              <option value="1961">1960/1961</option>
              <option value="1962">1961/1962</option>
              <option value="1963">1962/1963</option>
              <option value="1964">1963/1964</option>
              <option value="1965">1964/1965</option>
              <option value="1966">1965/1966</option>
              <option value="1967">1966/1967</option>
              <option value="1968">1967/1968</option>
              <option value="1969">1968/1969</option>
              <option value="1970">1969/1970</option>
              <option value="1971">1970/1971</option>
              <option value="1972">1971/1972</option>
              <option value="1973">1972/1973</option>
              <option value="1974">1973/1974</option>
              <option value="1975">1974/1975</option>
              <option value="1976">1975/1976</option>
              <option value="1977">1976/1977</option>
              <option value="1978">1977/1978</option>
              <option value="1979">1978/1979</option>
              <option value="1980">1979/1980</option>
              <option value="1981">1980/1981</option>
              <option value="1982">1981/1982</option>
              <option value="1983">1982/1983</option>
              <option value="1984">1983/1984</option>
              <option value="1985">1984/1985</option>
              <option value="1986">1985/1986</option>
              <option value="1987">1986/1987</option>
              <option value="1988">1987/1988</option>
              <option value="1989">1988/1989</option>
              <option value="1990">1989/1990</option>
              <option value="1991">1990/1991</option>
              <option value="1992">1991/1992</option>
              <option value="1993">1992/1993</option>
              <option value="1994">1993/1994</option>
              <option value="1995">1994/1995</option>
              <option value="1996">1995/1996</option>
              <option value="1997">1996/1997</option>
              <option value="1998">1997/1998</option>
              <option value="1999">1998/1999</option>
              <option value="2000">1999/2000</option>
              <option value="2001">2000/2001</option>
              <option value="2002">2001/2002</option>
              <option value="2003">2002/2003</option>
              <option value="2004">2003/2004</option>
              <option value="2005">2004/2005</option>
              <option value="2006">2005/2006</option>
              <option value="2007">2006/2007</option>
              <option value="2008">2007/2008</option>
              <option value="2009">2008/2009</option>
              <option value="2010">2009/2010</option>
              <option value="2011">2010/2011</option>
              <option value="2012">2011/2012</option>
              <option value="2013">2012/2013</option>
              <option value="2014">2013/2014</option>
              <option value="2015">2014/2015</option>
              <option value="2016">2015/2016</option>
              <option value="2017">2016/2017</option>
            </select>
            <div class="valid-feedback" id="valid2">
              Please select season
            </div>
          </div>
        </div>
        <div class="form-group row required">
          <label for="colFormLabelLg" class="col-sm-3 col-form-label col-form-label-lg col-xs-4">Country</label>
          <div class="col-sm-6 col-xs-8">
            <select class="custom-select form-control" id="CountryBtn" onclick="disableBtn()">
              <option selected value="99">Select Country</option>
              <option value="24">Albania</option>
              <option value="23">Andorra</option>
              <option value="31">Austria</option>
              <option value="41">Belarus</option>
              <option value="11">Belgium</option>
              <option value="25">Bosnia</option>
              <option value="28">Bulgaria</option>
              <option value="26">Croatia</option>
              <option value="29">Cyprus</option>
              <option value="32">Czech Republic</option>
              <option value="33">Denmark</option>
              <option value="42">Estonia</option>
              <option value="2">Faroe Islands</option>
              <option value="61">Finland</option>
              <option value="52">France</option>
              <option value="17">Georgia</option>
              <option value="38">Germany</option>
              <option value="7">Great Britain</option>
              <option value="51">Greece</option>
              <option value="34">Hungaria</option>
              <option value="0">Iceland</option>
              <option value="3">Ireland</option>
              <option value="60">Israel</option>
              <option value="50">Italia</option>
              <option value="43">Latvia</option>
              <option value="39">Liechtenstein</option>
              <option value="44">Lithuania</option>
              <option value="12">Luxembourg</option>
              <option value="27">Macedonia</option>
              <option value="8">Malta</option>
              <option value="45">Moldova</option>
              <option value="48">Montenegro</option>
              <option value="49">Netherland</option>
              <option value="14">Norway</option>
              <option value="35">Poland</option>
              <option value="13">Portugal</option>
              <option value="46">Romania</option>
              <option value="53">Russia</option>
              <option value="9">Santa Marina</option>
              <option value="20">Serbia</option>
              <option value="36">Slovakia</option>
              <option value="37">Slovenia</option>
              <option value="54">Spain</option>
              <option value="22">Sweden</option>
              <option value="40">Switzerland</option>
              <option value="30">Turkey</option>
              <option value="47">Ukraine</option>
            </select>
            <div class="valid-feedback" id="valid3">
              Please select country
            </div>
          </div>
        </div>
        <div class="form-group row">
          <label for="colFormLabelLg" class="col-sm-3 col-form-label col-form-label-lg col-xs-4">Club</label>
          <div class="col-sm-6 col-xs-8">
            <select class="custom-select form-control" disabled id="ClubBtn">
              <option selected id="optionClub" value="0" >Select Country Firstly</option>
            </select>
          </div>
        </div>
        <!--
        <div class="form-group row">
          <label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg col-xs-4">Include qualification stages?</label>
          <div class="col-sm-4 col-xs-4">
            <input class="form-check-input" type="checkbox" value="" id="defaultCheck1">
            <label class="form-check-label" for="defaultCheck1">YES</label>
          </div>
        </div>
      -->
        <div class="form-group row">
          <label for="colFormLabelLg" class="col-sm-3 col-form-label col-form-label-lg col-xs-4">Select Cup</label>
          <div class="col-sm-6 col-xs-8">
            <select class="custom-select form-control" id="CupBtn">
              <option selected value="0">All Cups</option>
              <option value="CHAMPIONS CUP">CHAMPIONS CUP</option>
              <option value="CHAMPIONS LEAGUE">CHAMPIONS LEAGUE</option>
              <option value="CUP WINNERS CUP">CUP WINNERS CUP</option>
              <option value="EUROPA LEAGUE">EUROPA LEAGUE</option>
              <option value="INTER-CITIES FAIRS CUP">INTER-CITIES FAIRS CUP</option>
              <option value="UEFA CUP">UEFA CUP</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label for="colFormLabelLg" class="col-sm-3 col-form-label col-form-label-lg col-xs-4">Select Stage</label>
          <div class="col-sm-6 col-xs-8">
            <select multiple class="custom-select form-control" style="height:120px" id="StageBtn">
              <option selected value="1">Qualifications</option>
              <option selected value="2">Group Stage</option>
              <option selected value="3">Round Stage</option>
              <option selected value="4">Quarter Finals</option>
              <option selected value="5">Semi Finals</option>
              <option selected value="6">Final</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-sm-3 col-xs-4">
            <button class="btn btn-success" type="button" onclick="ClearCriteria()" style="margin-bottom: 30px;">Clear Criteria</button>
          </div>
          <div class="col-sm-4 col-xs-8">
            <button class="btn btn-primary" type="button" onclick="SubmitBtn()" style="margin-bottom: 30px;">Submit</button>
          </div>
        </div>
      </form>
</div>



      {% include "mysite/footer.html" %}

    </body>
<script>

var checkCountry = document.getElementById("CountryBtn").value

function disableBtn() {
    if ( checkCountry != document.getElementById("CountryBtn").value){
      if (document.getElementById("CountryBtn").value != "99"){
        document.getElementById("ClubBtn").disabled = false;
        document.getElementById("optionClub").innerHTML= "All clubs for selected country";
        GetCountries(document.getElementById("CountryBtn").value, false);
        checkCountry = document.getElementById("CountryBtn").value
      } else {
        document.getElementById("ClubBtn").disabled = true;
        document.getElementById("optionClub").innerHTML= "Select Country Firstly";
      }
    }
}

function checkSeasons(){

  if (document.getElementById("StSeasonBtn").value != "Select season"){

    var elements = document.getElementById("EndSeasonBtn").getElementsByTagName('option');
    for (var i = 0; i < elements.length; i++) {

        if (document.getElementById("StSeasonBtn").value > elements[i].value){
        //console.log(elements[i].value)
        elements[i].disabled=true;
      }else {
        elements[i].disabled=false;
      }
    }
    if (document.getElementById("StSeasonBtn").value > document.getElementById("EndSeasonBtn").value){
    document.getElementById("EndSeasonBtn").value="0"}
  }
}

function SubmitBtn() {

        var StartSelected= document.getElementById("StSeasonBtn").value
        var EndSelected=document.getElementById("EndSeasonBtn").value
        var CountrySelected=document.getElementById("CountryBtn").value
        var ClubSelected=document.getElementById("ClubBtn").value
        var CupSelected=document.getElementById("CupBtn").value
        var StageSelected = getSelectValues(document.getElementById("StageBtn"))
        //console.log(StageSelected)
        if (StartSelected != 0 & EndSelected != 0 & CountrySelected != 99){

          document.getElementById("valid1").className = "valid-feedback"
          document.getElementById("valid2").className = "valid-feedback"
          document.getElementById("valid3").className = "valid-feedback"

         $.ajax({
             url:"/SetCriteria/",
             method: "GET", // or POST
             dataType: "json",
             data: {
             //csrfmiddlewaretoken: csrf_token,
             StartSelected:StartSelected,
             EndSelected:EndSelected,
             CountrySelected:CountrySelected,
             ClubSelected:ClubSelected,
             CupSelected:CupSelected,
             StageSelected:StageSelected
              },
             success:function(results){
               console.log(results)
               window.alert("Your criteria are approved! \n \nNow, you can see the the list of all matches, statistics and stats against another countries.");
             },
             failure: function(qXHR, textStatus, errorThrown) {
             handleError(qXHR, textStatus, errorThrown)
             }
         }).fail(function(qXHR, textStatus, errorThrown){
              handleError(qXHR, textStatus, errorThrown)
         });
       } else {
         //window.alert("You need fill mandatory fields: range of seasons and country")
                if (StartSelected == 0){
                  document.getElementById("valid1").className = "invalid-feedback"
                }
                if (EndSelected == 0){
                  document.getElementById("valid2").className = "invalid-feedback"
                }
                if (CountrySelected == 99){
                  document.getElementById("valid3").className = "invalid-feedback"
                }
       }
  }

  function getSelectValues(select) {
    var result = [];
    var options = select && select.options;
    var opt;

    for (var i=0, iLen=options.length; i<iLen; i++) {
      opt = options[i];

      if (opt.selected) {
        result.push(opt.value || opt.text);
      }
    }
    return result;
  }

function GetCountries(CountryCode, IfsetCountry){
  console.log(CountryCode)
  $.ajax({
      url:"/GetClubs/",
      method: "GET", // or POST
      dataType: "json",
      data: {
      //csrfmiddlewaretoken: csrf_token,
      CountryCode:CountryCode
       },
      success:function(results){
        removeClubs();
        results['clubs'].forEach(addClubs);
         if (IfsetCountry){
           document.getElementById("ClubBtn").value='{{criteria.ClubSelected}}'
         }
      },
      failure: function(qXHR, textStatus, errorThrown) {
      handleError(qXHR, textStatus, errorThrown)
      }
  }).fail(function(qXHR, textStatus, errorThrown){
       handleError(qXHR, textStatus, errorThrown)
  });

}

var select = document.getElementById('ClubBtn');

function removeClubs(){
  while (select.length > 1) {
    select.remove(1);
  }
}

function addClubs(item){
  var opt = document.createElement('option');
  opt.value = item;
  opt.innerHTML = item;
  select.appendChild(opt);
}

function ClearCriteria(){
  document.getElementById("StSeasonBtn").value ="0"
  document.getElementById("EndSeasonBtn").value="0"
  document.getElementById("CountryBtn").value="99"
  document.getElementById("ClubBtn").value="0"
  document.getElementById("CupBtn").value="0"
  document.getElementById("ClubBtn").disabled = true;
  document.getElementById("optionClub").innerHTML= "Select Country Firstly";

  var selectStage = document.getElementById('StageBtn').options;
  for (var i = 0; i < selectStage.length; i++){
    selectStage[i].selected = true
  }
}
console.log("{{criteria}}")
if ("{{criteria}}" != 'empty' & "{{criteria}}" != 'emptyRedirect'){

  var criteriaStage = '{{criteria.StageSelected}}'
  criteriaStage = criteriaStage.replace(/&#39;/g,"").replace(/]/g,"").replace("[","")
  var StageArray = criteriaStage.split(", ");

  document.getElementById("StSeasonBtn").value ='{{criteria.StartSelected}}'
  document.getElementById("EndSeasonBtn").value='{{criteria.EndSelected}}'
  document.getElementById("CountryBtn").value='{{criteria.CountrySelected}}'
  document.getElementById("CupBtn").value='{{criteria.CupSelected}}'

  if ('{{criteria.CountrySelected}}' != "99"){
    document.getElementById("ClubBtn").disabled = false;
    document.getElementById("optionClub").innerHTML= "All clubs for selected country";
  }
  if ('{{criteria.ClubSelected}}' != "0"){
    GetCountries('{{criteria.CountrySelected}}', true)
  } else {
    GetCountries('{{criteria.CountrySelected}}', false)
  }

  checkCountry = document.getElementById("CountryBtn").value
  var selectStage = document.getElementById('StageBtn').options;

  for (var i = 0; i < selectStage.length; i++){
    if (StageArray.indexOf(selectStage[i].value) != -1){
      selectStage[i].selected = true
    } else {
      selectStage[i].selected = false
    }
  }
} else if("{{criteria}}" == 'emptyRedirect'){
  ClearCriteria()
  window.alert("You have to select criteria first!");
}
else {
  ClearCriteria()
}

</script>

</html>
